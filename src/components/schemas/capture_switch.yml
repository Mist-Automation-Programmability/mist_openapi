description: Initiate a Switch (Junos) Packet Capture
properties:
  duration:
    default: 600
    description: duration of the capture, in seconds
    example: 600
    maximum: 86400
    minimum: 0
    type: integer
  format:
    default: stream
    enum:
    - stream
    type: string
  max_pkt_len:
    default: 512
    description: max_len of each packet to capture
    example: 1500
    maximum: 2048
    minimum: 128
    type: integer
  num_packets:
    default: 1024
    description: number of packets to capture, 0 for unlimited
    example: 100
    type: integer
  ports:
    description: dict of port which uses port id as the key
    items:
      type: string
    maxItems: 6
    type: array
  switches:
    additionalProperties:
      properties:
        ports:
          additionalProperties:
            nullable: true
            type: object
          description: Property key is the interface name
          type: object
      type: object
    description: Property key is the switch mac
    type: object
  tcpdump_expression:
    description: tcpdump expression, port specific if specified under ports dict,
      otherwise applicable across ports if specified at top level of payload. Port
      specific value overrides top level value when both exist.
    example: port 443
    type: string
  type:
    enum:
    - switch
    example: switch
    type: string
required:
- type
title: capture_switch
type: object
