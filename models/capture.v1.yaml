title: capture
oneOf:
  - description: Initiate a Client Packet Capture
    properties:
      type:
        type: string
        minLength: 1
        enum:
          - client
        description: client
        default: client
      client_mac:
        type: string
        minLength: 1
        description: 'client mac, required if type==client; optional otherwise'
      num_packets:
        description: 'number of packets to capture, 0 for unlimited, default is 1024 for client-capture'
        default: 1024
        type: integer
      duration:
        description: 'duration of the capture, in seconds, default is 600, maximum is 86400'
        default: 600
        type: integer
      max_pkt_len:
        type: integer
      includes_mcast:
        type: boolean
        description: ''
      ssid:
        description: optional filter by ssid
        type: string
      ap_mac:
        type: string
    required:
      - type
  - description: Initiate a packet Capture for New Wireless Client Associations
    properties:
      type:
        type: string
        minLength: 1
        enum:
          - new_assoc
        default: new_assoc
        description: new-assoc
      client_mac:
        type: string
        minLength: 1
        description: 'client mac, required if type==client; optional otherwise'
      num_packets:
        description: 'number of packets to capture, 0 for unlimited, default is 100 for new association'
        default: 1024
        type: integer
      duration:
        description: 'duration of the capture, in seconds, default is 600, maximum is 86400'
        default: 600
        type: integer
      max_pkt_len:
        type: integer
      includes_mcast:
        type: boolean
        description: ''
      ssid:
        description: optional filter by ssid
        type: string
      ap_mac:
        type: string
    required:
      - type
  - description: Initiate a Wired Packet Capture
    properties:
      type:
        type: string
        minLength: 1
        enum:
          - wired
        description: wired
        default: wired
      num_packets:
        description: 'number of packets to capture, 0 for unlimited, default is 1024 for wired-capture'
        default: 1024
        type: integer
      duration:
        description: 'duration of the capture, in seconds, default is 600, maximum is 86400'
        default: 600
        type: integer
      max_pkt_len:
        type: integer
        description: 'max_len of each packet to capture, default is 128, maximum is 2048'
        default: 128
        maximum: 2048
      tcpdump_expression:
        type: string
        description: tcpdump expression
      ap_mac:
        type: string
      format:
        type: string
        enum:
          - pcap
          - string
        default: pcap
        description: 'pcap format, pcap / stream, default is pcap'
    required:
      - type
  - description: Initiate a WLAN Packet Capture
    properties:
      type:
        type: string
        minLength: 1
        description: wlan
        default: wlan
        enum:
          - wlan
      num_packets:
        description: 'number of packets to capture, 0 for unlimited, default is 1024 for wlan-capture'
        default: 1024
        type: integer
      duration:
        description: 'duration of the cpture, in seconds, default is 600, maximum is 86400'
        default: 600
        type: integer
      max_pkt_len:
        type: integer
        description: 'max_len of each packet to capture, default is 128, maximum is 2048'
        default: 128
        maximum: 2048
      ap_mac:
        type: string
      format:
        type: string
        enum:
          - pcap
          - string
        default: pcap
        description: 'pcap format, pcap / stream, default is pcap'
      wlan_id:
        type: string
        description: WLAN ID
      band:
        type: string
        description: '2.4 / 5, default is 2.4'
        default: '2.4'
        enum:
          - '2.4'
          - '5'
    required:
      - type
  - description: Initiate a Radiotap Packet Capture
    properties:
      type:
        type: string
        minLength: 1
        description: radiotap
        default: radiotap
        enum:
          - radiotap
      num_packets:
        description: 'number of packets to capture, 0 for unlimited, default is 1024 for radiotap-capture'
        default: 1024
        type: integer
      duration:
        description: 'duration of the cpture, in seconds, default is 600, maximum is 86400'
        default: 600
        type: integer
      max_pkt_len:
        type: integer
        description: 'max_len of each packet to capture, default is 128, maximum is 2048'
        default: 128
        maximum: 2048
      ap_mac:
        type: string
      format:
        type: string
        enum:
          - pcap
          - stream
        default: pcap
        description: 'pcap format, pcap / stream, default is pcap'
      band:
        type: string
        description: '2.4 / 5, default is 2.4'
        default: '2.4'
        enum:
          - '2.4'
          - '5'
    required:
      - type
x-examples:
  Client Packet Capture:
    value:
      type: client
      client_mac: 60a10a773412
      num_packets: 1000
      duration: 300
      max_pkt_len: 128
      includes_mcast: false
  New Wireless Client Associations Packet Capture:
    value:
      type: new_assoc
      num_packets: 100
      duration: 600
      max_pkt_len: 128
      includes_mcast: false
      client_mac: 60a10a773412
  Wired Packet Capture:
    value:
      type: wired
      num_packets: 100
      duration: 600
      max_pkt_len: 68
      tcpdump_expression: tcp port 80
  Wlan Packet Capture:
    value:
      type: wlan
      num_packets: 100
      duration: 600
      max_pkt_len: 68
  Radiotap Packet Capture:
    value:
      type: wlan
      num_packets: 100
      duration: 600
      max_pkt_len: 68
type: object
description: capture
