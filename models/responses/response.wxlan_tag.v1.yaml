description: |-
  * type:
  ** client: created manually (e.g. on wireless client table, when they spot a device of interest, they can create an wxlan tag for it
  ** resource: created automatically when we discover a network resource
  ** subnet: create automatically when a subnet is discovered

  * match:
  ** wlan_id, ap_id: values are a list of Wlan / Device ids
  ** client_mac: values are a list of MAC addresses

  * radius_group: this is a smart tag that matches RADIUS-Filter-ID, Airespace-ACL-Name (VendorID=14179, VendorType=6) / Aruba-User-Role (VendorID=14823, VendorType=1)
  * radius_username: this matches the ATTR-User-Name(1)
  * radius_class: thie matches the ATTR-Class(25)
  * radius_attr: the values are [ “6=1”, “26=10.2.3.4” ], this support other RADIUS attributes where we know the type
  * radius_vendor: the values are [ “14179.10=1”, “14178.16=1.2.3.4” ], this matches vendor attributes and will be dynamically evaluated
type: object
properties:
  id:
    type: string
    minLength: 1
  name:
    type: string
    minLength: 1
  msp_id:
    type: string
    minLength: 1
  org_id:
    type: string
    minLength: 1
  site_id:
    type: string
    minLength: 1
  created_time:
    type: integer
  modified_time:
    type: integer
  type:
    type: string
    minLength: 1
    description: match / client / resource / subnet
    enum:
      - match
      - client
      - resource
      - subnet
  match:
    type: string
    minLength: 1
    description: 'type of match, wlan_id / ap_id / client_mac / ip_range_subnet / radius_group / radius_username / radius_attr / hostname / app / port'
    enum:
      - wlan_id
      - ap_ip
      - client_mac
      - ip_range_subnet
      - radius_group
      - radius_username
      - radius_attr
      - hostname
      - app
      - port
  values:
    type: array
    description: list of values to match
    items:
      type: string
  op:
    type: string
    description: in / not_in, default is in
    enum:
      - in
      - not_in
  resource_mac:
    type: string
  mac:
    type: string
  services:
    type: array
    items:
      type: string
  last_ips:
    type: array
    items:
      type: string
  subnet:
    type: string
  specs:
    type: array
    items:
      type: object
      properties:
        protocol:
          type: string
          description: 'tcp / udp / icmp / gre / any / ":protocol_number", `protocol_number` is between 1-254, default is `any`'
          enum:
            - tcp
            - udp
            - icmp
            - gre
            - any
            - ':protocol_number'
        subnet:
          type: array
          description: 'matched dst subnet, default is "0.0.0.0/0"'
          items:
            type: string
        port_range:
          type: string
          description: 'matched dst port, "0" means any, default is "0"'
required:
  - type
  - name
  - match
  - values
x-examples:
  example-1:
    id: string
    name: string
    msp_id: string
    org_id: string
    site_id: string
    created_time: 0
    modified_time: 0
    type: match
    match: wlan_id
    values:
      - string
    op: in
    resource_mac: string
    mac: string
    services:
      - string
    last_ips:
      - string
    subnet: string
    specs:
      - protocol: tcp
        subnet:
          - string
        port_range: string
